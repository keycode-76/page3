import{u as k,_ as l}from"./index-DMd0utxA.js";const S={1:{name:"Ground_worm",order:[3,1,1],attack:1,heart:20,like:"E6D_bullet",bg:"enemy-1"},2:{name:"Rat",order:[3,1,1],attack:1,heart:20,like:"E6D_bullet",bg:"enemy-2"}},N={1:{name:"Corpse",is:1,bg:"item-corpse-1"},2:{name:"Corpse",is:2,bg:"item-corpse-2"},3:{name:"Corpse",is:3,bg:"item-corpse-3"},4:{name:"Corpse",is:4,bg:"item-corpse-4"},5:{name:"Corpse",is:5,bg:"item-corpse-5"},6:{name:"Corpse",is:6,bg:"item-corpse-6"},7:{name:"Corpse",is:7,bg:"item-corpse-7"},8:{name:"Corpse",is:8,bg:"item-corpse-8"},9:{name:"Corpse",is:9,bg:"item-corpse-9"},10:{name:"Corpse",is:10,bg:"item-corpse-10"}},v={1:{is:1,bg:"item-landscape-1"},2:{is:2,bg:"item-landscape-2"},3:{is:3,bg:"item-landscape-3"},4:{is:4,bg:"item-landscape-4"},5:{is:5,bg:"item-landscape-5"},6:{is:6,bg:"item-landscape-6"},7:{is:7,bg:"item-landscape-8"},9:{is:9,bg:"item-landscape-9"},10:{is:10,bg:"item-landscape-10"}},W={0:{is:1,bg:"lostbag-1"},1:{is:1,bg:"lostbag-1"},2:{is:2,bg:"lostbag-2"},3:{is:3,bg:"lostbag-3"},4:{is:4,bg:"lostbag-4"},5:{is:5,bg:"lostbag-5"},6:{is:6,bg:"lostbag-6"},7:{is:7,bg:"lostbag-8"},9:{is:9,bg:"lostbag-9"},10:{is:10,bg:"lostbag-10"}},p={enemy:S,corpse:N,landscape:v,lostbag:W},h={x:10,y:10},m=[["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","S_LM2","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","NS_LS2","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","NS_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","SE_0000","WE_0000","WE_0000","WE_0000","NW_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","NS_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","NS_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","E_0000","NSWE_LM1","W_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","N_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"],["x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000","x_0000"]];let D,L,O,M,C,I,s;async function R(){try{switch(k){case"EN":s=await l(()=>import("./lines_EN-BkyJInZe.js"),[]);break;case"ES":s=await l(()=>import("./lines_ES-zVbe91m0.js"),[]);break;case"CH":s=await l(()=>import("./lines_CH-DaRAnddl.js"),[]);break;default:s=await l(()=>import("./lines_EN-BkyJInZe.js"),[]);return}}catch(e){console.error("Error loading JSON file:",e)}}function n(e,x){return Math.floor(Math.random()*(x-e+1))+e}let c=null;async function q(){try{if(!p)throw new Error("Dungeon data is undefined!");c=p}catch(e){console.error("Error loading dungeon data:",e)}}function u(e){if(!c||!c[e])return console.error(`Data for type "${e}" is not available.`),null;const x=Object.keys(c[e]),_=x[n(0,x.length-1)];return c[e][_]}const P={Flint_stone:{low:5,high:15,limit:5,is:"attack",attack:1},Bone_piece:{low:5,high:15,limit:5,is:"attack",attack:2},Fur_pelt:{low:5,high:15,limit:5,is:"attack",attack:1},Raw_meat:{low:5,high:15,limit:5,is:"heal",heal:1}},y=Object.keys(P);function f(){const e=[1,2],x={},_=[];for(;_.length<2;){const t=y[n(0,y.length-1)];_.includes(t)||_.push(t)}return _.forEach(t=>{x[t]=n(e[0],e[1])}),x}const w=m.length,E=m[0].length;let a={};async function A(){if(!c){console.error("Dungeon data is not loaded yet.");return}let e=u("enemy"),x=u("lostbag");if(!e||!x){console.error("數據加載失敗，請檢查 JSON 資料來源。");return}for(let _=0;_<w;_++)for(let t=0;t<E;t++){let r=function(){let i;switch(Math.random()<.2?i="lostbag":i="enemy",i){case"lostbag":return{type:"item",x:8,y:20,w:36,h:25,bg:x.bg,is:x.is,reward:{...f()}};case"enemy":return{type:"enemy",name:e.name,order:e.order,attack:e.attack,x:13,y:33,w:25,h:25,heart:e.heart,carapace:e.carapace,flexibility:e.flexibility,anger:e.anger,like:e.like,reward:{...f()},bg:e.bg}}};const o=m[_][t];if(o==="x_0000")continue;a[`${_},${t}`]={type:"room",btn:{},bg:{},ux:[],efx:"dark"};const $=o.replace(/\(.*\)/,"");J($,t,_,E,w);const g=a[`${_},${t}`].bg,b=["N","E","S","W"].filter(i=>{var d;return(d=g[i])==null?void 0:d.includes("map_wall_")}).length;if(Math.random()<.8&&!o.includes("L")&&b<3){const i=r();i&&a[`${_},${t}`].ux.push(i)}T(o,_,t,a)}}function J(e,x,_,t,o){const r=e.split("_")[1];["N","E","S","W"].forEach((g,b)=>{const i=parseInt(r[b]);switch(g){case"N":e.includes("N")&&_>0&&(a[`${_},${x}`].btn.N=`${_-1},${x}`,a[`${_},${x}`].bg.N=`map_aisle_${i}_${n(1,2)}`);break;case"E":e.includes("E")&&x<t-1&&(a[`${_},${x}`].btn.E=`${_},${x+1}`,a[`${_},${x}`].bg.E=`map_aisle_${i}_${n(1,2)}`);break;case"S":e.includes("S")&&_<o-1&&(a[`${_},${x}`].btn.S=`${_+1},${x}`,a[`${_},${x}`].bg.S=`map_aisle_${i}_${n(1,2)}`);break;case"W":e.includes("W")&&x>0&&(a[`${_},${x}`].btn.W=`${_},${x-1}`,a[`${_},${x}`].bg.W=`map_aisle_${i}_${n(1,2)}`);break}a[`${_},${x}`].bg.N||(a[`${_},${x}`].bg.N=`map_wall_${i}`),a[`${_},${x}`].bg.S||(a[`${_},${x}`].bg.S=`map_wall_${i}`),a[`${_},${x}`].bg.W||(a[`${_},${x}`].bg.W=`map_wall_${i}`),a[`${_},${x}`].bg.E||(a[`${_},${x}`].bg.E=`map_wall_${i}`)})}function T(e,x,_,t){e.includes("LM1")?(t[`${x},${_}`].bg.N=`map_aisle_0_${n(1,2)}`,t[`${x},${_}`].bg.S="s1-home-1",t[`${x},${_}`].bg.E="s1-home-2",t[`${x},${_}`].bg.W="s1-home-3",t[`${x},${_}`].S=[{x:10,y:55,w:20,h:20,type:"unique",is:"craft"}],t[`${x},${_}`].E=[{x:10,y:55,w:20,h:20,type:"unique",is:"inventory"}],t[`${x},${_}`].W=[{x:10,y:55,w:20,h:20,type:"unique",is:"shop",who:"base"}]):e.includes("LM2")?(t[`${x},${_}`].bg.N="s1-mechanic-1",t[`${x},${_}`].bg.E="map_wall_0",t[`${x},${_}`].bg.S="map_wall_0",t[`${x},${_}`].bg.W="map_wall_0",t[`${x},${_}`].N=[{x:25,y:25,w:20,h:10,type:"npc",is:0,name:"Mechanic",lyric:"mechanic"},{x:38,y:40,w:6,h:6,type:"unique",is:"sharebox",bg:"share_box"}]):e.includes("LS2")&&(t[`${x},${_}`].bg.N="s1-mechanic-2",t[`${x},${_}`].bg.E="map_wall_0",t[`${x},${_}`].bg.S="map_aisle_0_1",t[`${x},${_}`].bg.W="map_wall_0",t[`${x},${_}`].N=[{x:25,y:25,w:20,h:10,type:"npc",is:"harvey",name:"???",lyric:"npc",change:[{x:25,y:25,w:20,h:10,type:"unique",is:"shop",who:"harvey"},{x:38,y:40,w:6,h:6,type:"npc",is:"heart",name:"harvey",lyric:"harvey"},{x:20,y:20,w:16,h:6,type:"npc",is:"mechanic",name:"harvey",lyric:"harvey"}]}])}async function V(){await q(),await A()}const F=async()=>{if(console.log("Initializing scene..."),await R(),!s){console.error("lines_JSON 加載失敗");return}if(await V(),!Object.keys(a).length){console.error("rand_map_arr 尚未初始化");return}L=s.s_main_line,M=s.s_harvey_line,C=s.s_hospital_line,O=s.s_npc_line,I=s.s_landscape_line,D={0:{type:"line",bg:"",is:`${h.x},${h.y}`},...a,dream_start:{type:"line",bg:"s1-dream",is:"dream_choice"},dream_choice:{type:"view",bg:"s1-dream-choice",ux:[{x:8,y:58,w:8,h:8,type:"choice",is:"left",bg:""},{x:38,y:58,w:8,h:8,type:"choice",is:"right",bg:""},{x:25,y:68,w:8,h:8,type:"choice",is:"battle",bg:"sanity_choice_battle"}]},dream_battle:{type:"view",bg:"s1-dream",ux:[{type:"boss",speed:2e3,power:9,heart:2,is:"dream_win",bg:"s1-dream-enemy"}]},dream_win:{type:"line",bg:"s1-dream",is:"return",reward:{ground_meat:2,ground_meat:2,ground_meat:2}},dream_correct:{type:"line",bg:"s1-dream",is:"return"},dream_wrong:{type:"line",bg:"s1-dream",is:"dead"},dead:{type:"end",bg:"",dead:"dead in fight"}}};export{m as mapData,D as s_data,M as s_harvey_line,C as s_hospital_line,F as s_init,I as s_landscape_line,L as s_lines,O as s_npc_line,h as start_locat};
